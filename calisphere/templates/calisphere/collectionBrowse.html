{% extends "calisphere/base.html" %}
{% load calisphere-extras %}
{% load staticfiles %}
{% load humanize %}

{% block title %}: {{ collection.name }}{% endblock %}
{% block page-metadata %}
{% include "calisphere/microdata.html" with title=collection.name description=collection.description %}
{% endblock %}

{% block content %}
  <nav class="breadcrumb--style1" aria-label="breadcrumb navigation">
    <ul>
      <li>
        <a href="{% url 'calisphere:collectionsDirectory' %}" data-pjax="js-pageContent">Collections</a>
      </li>
    </ul>
  </nav>

  <h1 id="js-collection" data-collection="{{ collection_id }}" data-referralName="{{ collection.name }}">
    {{ collection.name }}
  </h1>


<div class="collection-intro" data-ga-dim1="{{ collection.local_id }}{{ collection.slug }}">
  <div class="col-md-3">
    <div class="collection-intro__institution">
      <h2 class="collection-intro__institution-heading">Owning Institution{{ collection.repository|pluralize }}:
        {% for repository in collection.repository %}
          {% if 'campus' in repository and repository.campus.0.name %}
            <a
              href="{% url 'calisphere:campusView' repository.campus.0.slug 'collections' %}"
              class="collection-intro__institution-heading-link"
              data-pjax="js-pageContent"
            >{{ repository.campus.0.name }}</a>,
          {% endif %}
          <a
            href="{% url 'calisphere:repositoryView' repository.resource_id 'collections' %}"
            class="collection-intro__institution-heading-link"
            data-pjax="js-pageContent"
            data-ga-code="{{ repository.google_analytics_tracking_code }}"
            data-ga-dim2="{%if 'campus' in repository and repository.campus.0.name %}{{ repository.campus.0.slug }}-{% endif %}{{ repository.slug }}"
          >
            {{ repository.name }}
          </a>
          {% if forloop.counter < collection.repository|length %} and {% endif %}
        {% endfor %}
      </h2>
    </div>
  </div>

  <div class="col-md-9">
    <div class="collection-intro__about">
      {% if 'description' in collection %}
      <h3 class="collection-intro__about-heading">About this Collection</h3>
        <span class="collection-intro__about-description">
          {{ collection.description|urlize }}
        </span>
      {% endif %}
      {% if collection.url_local|length > 0 %}
        <a class="collection-intro__about-link" href="{{ collection.url_local }}" target="_blank">View this collection on the contributor's website.</a><br/>
      {% endif %}
      {% if collection.url_oac|length > 0 %}
        <a class="collection-intro__about-link" href="{{ collection.url_oac }}" target="_blank">View collection guide.</a>
      {% endif %}
      <label for="{{ collection_id }}" aria-hidden="true" class="display-none">Current Collection ID</label>
      <input id="{{ collection_id }}" class="facet js-facet facet-collection_data display-none" form="js-facet" type="checkbox" name="collection_data" value="{{ collection_id }}" checked aria-hidden="true">

    </div>
  </div>

</div>

<div class="row">
  <div class="col-md-3">
    <div class="snapshot" style="border: 1px solid black; padding: 10px; margin-right: 10px;">
      <h3>Collection Snapshot</h3>
        {{ item_count|intcomma }} total items in this collection<br/><br/>
        {% for cluster in clusters %}
          {{ cluster.unique }} unique {{ cluster.facet }}s<br/>
        {% endfor %}
    </div>
  </div>

  <div class="col-md-9">
    {% for cluster in clusters %}
    <div class="explore-clusters" style="border: 1px solid black; padding: 10px; margin-bottom: 10px;">
      <h3>Explore {{ cluster.facet|title }}s Used in this Collection</h3>
      <h4>Three Sample {{ cluster.facet|title }}s</h4>
      <ol>
        {% for value in cluster.values %}
          <li><a href="{% url 'calisphere:collectionFacetValue' collection_id cluster.facet value.label|qencode %}?view_format=list">{{ value.label }} ({{ value.count|intcomma }} items)</a></li>
        {% endfor %}
      </ol>
      <a href="{{ form_action }}{{ cluster.facet }}/">See all {{ cluster.unique|intcomma }} unique {{ cluster.facet }}s</a>
    </div>
    {% endfor %}
  </div>
</div>


{% endblock %}
