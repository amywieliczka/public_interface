{% load calisphere-extras %}

<p class="text__breadcrumb-nav">
  {% if item.parsed_repository_data %}
    <a href="{% url 'calisphere:repositoryView' item.parsed_repository_data.0.id 'collections' %}" data-pjax="js-pageContent">
      {% if item.parsed_repository_data.0.campus %}{{ item.parsed_repository_data.0.campus }}, {% endif %}
      {{ item.parsed_repository_data.0.name }}
    </a>
  {% endif %}
   >
  {% if item.parsed_collection_data %}
    <a href="{% url 'calisphere:collectionView' item.parsed_collection_data.0.id %}" data-pjax="js-pageContent" class="js-relatedCollection">{{ item.parsed_collection_data.0.name }}</a>
  {% endif %}
   > {{ item.title.0 }}
</p>

<h1 class="obj__heading">
  {% if item.harvest_type == 'hosted' %}
    {% if item.multiFormat %}Multi-format{% else %}{{ item.type.0|title }}{% endif %}{% if 'structMap' in item %} set{% else %}{% endif %}
  {% else %}
    {{ item.type.0|title }}
  {% endif %}
 / <strong>{{ item.title.0|truncatewords:12 }}</strong></h1>

{% if item.complex_object %}
<div class="modal fade" id="parentMetadata" tabindex="-1" role="dialog" aria-labelledby="parentModalTitle">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="parentModalTitle">Summary Information.</h4>
      </div>
      <div class="modal-body">
        {% include "calisphere/item-metadata.html" %}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<h2>Summary Information</h2>
<div id="complex_object_summary" style="border: 1px solid black; padding: 10px; height: 150px; overflow: scroll; margin-bottom: 15px">
  {% if 'description' in item %}
    {% for description in item.description %}{{ description }} <br> {% endfor %}
  {% endif %}<br/>
  <a href="javascript: void(0)" data-toggle="modal" data-target="#parentMetadata">See Complete Summary</a>
</div>
{% include "calisphere/itemButtons.html" %}
{% endif %}

{% if item.complex_object %}
<div class="row">
<div class="col-md-3">
  <h3>Contents</h3>

  {% for component in item.structMap %}
    <a class="js-component-link" data-item_id="{{ forloop.counter0 }}" href="{% url 'calisphere:itemView' item.id %}">
      {{ component.label }}
    </a><br/>
  {% endfor %}

</div>
<div class="col-md-9">
{% endif %}

<div id="js-objectViewport" data-item_id="{{item.id}}">
{% if item.harvest_type == 'hosted' and 'structMap' in item %}
  {% include 'calisphere/objectViewer/complex-object.html' %}
{% elif item.harvest_type == 'hosted' and item.contentFile.format == 'image' %}
  {% include 'calisphere/objectViewer/hosted-simple-image.html' %}
{% elif item.harvest_type == 'hosted' and item.contentFile.format == 'video' %}
  {% include 'calisphere/objectViewer/hosted-simple-video.html' %}
{% elif item.harvest_type == 'hosted' and item.contentFile.format == 'audio' %}
  {% include 'calisphere/objectViewer/hosted-simple-audio.html' %}
{% elif item.harvest_type == 'hosted' and item.contentFile.format == 'file' %}
  {% include 'calisphere/objectViewer/hosted-simple-file.html' %}
{% else %}
  {% include 'calisphere/objectViewer/object-tiles-and-overlays.html' %}
{% endif %}
</div>

{% if item.complex_object %}
</div>
</div>
{% endif %}

{% if not item.complex_object %}
  {% include "calisphere/itemButtons.html" %}
{% endif %}

<h3 class="meta-heading">
  {% if item.harvest_type == 'harvested' %}
    Item Information.
    <a class="meta-heading__preview-link" href="{{ item.url_item }}">
      View source record on
      {% if item.oac == True %}
        the Online Archive of California.
      {% else %}
        contributor's website.
      {% endif %}
    </a>
  {% elif item.harvest_type == 'hosted' %}
    {% if 'structMap' in item and 'selected' in item and item.selected == True %}
      Summary Information.
    {% elif 'structMap' in item %}
      Item information. <a href="{% url 'calisphere:itemView' item.id %}" class="js-set-link">Go to summary information.</a>
    {% else %}
      Item Information.
    {% endif %}
  {% endif %}
</h3>

{% if 'selected' in item and item.selected == False %}
  {% include "calisphere/component-metadata.html" %}
{% else %}
  {% include "calisphere/item-metadata.html" %}
{% endif %}

{% if item.parsed_collection_data.0.disqus_shortname %}
<div class="comment">
  <div id="disqus_loader" class="comment_clickthrough" data-disqus="{{ item.parsed_collection_data.0.disqus_shortname }}">
    <div class="comment__text">
      <h2>New! This item supports comments!</h2>
      <p>We are testing a commenting feature on this item. <button class="button__link js-disqus">Load comments</button>.</p>
    </div>
    <button class="comment__link js-disqus">Join The <br>Discussion</button>
  </div>

  <div style="display: block; clear: both;">
    <div id="disqus_thread"></div>
  </div>
</div>
{% endif %}
